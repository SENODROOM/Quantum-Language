{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "name": "Quantum",
  "scopeName": "source.quantum",
  "patterns": [
    { "include": "#block_comments" },
    { "include": "#line_python" },
    { "include": "#line_cpp" },
    { "include": "#line_c" },
    { "include": "#line_js" },
    { "include": "#line_default" }
  ],
  "repository": {

    "block_comments": {
      "patterns": [
        {
          "name": "comment.block.quantum",
          "begin": "/\\*",
          "end":   "\\*/",
          "beginCaptures": { "0": { "name": "comment.block.quantum" } },
          "endCaptures":   { "0": { "name": "comment.block.quantum" } }
        }
      ]
    },

    "line_comment_green": {
      "patterns": [
        {
          "name": "comment.line.number-sign.quantum",
          "match": "#.*$"
        }
      ]
    },

    "line_python": {
      "comment": "Lines tagged with #Python at end — colored like Python",
      "begin": "^(?=.*#\\s*Python\\s*$)",
      "end":   "$",
      "name":  "meta.line.python.quantum",
      "patterns": [
        { "include": "#python_comment" },
        { "include": "#shared_strings" },
        { "include": "#shared_numbers" },
        { "include": "#python_keywords" },
        { "include": "#python_builtins" },
        { "include": "#python_constants" },
        { "include": "#shared_operators" },
        { "include": "#shared_functions" }
      ]
    },

    "line_cpp": {
      "comment": "Lines tagged with #C++ at end — colored like C++",
      "begin": "^(?=.*#\\s*C\\+\\+\\s*$)",
      "end":   "$",
      "name":  "meta.line.cpp.quantum",
      "patterns": [
        { "include": "#cpp_comment" },
        { "include": "#shared_strings" },
        { "include": "#shared_numbers" },
        { "include": "#cpp_types" },
        { "include": "#cpp_keywords" },
        { "include": "#cpp_builtins" },
        { "include": "#shared_operators" },
        { "include": "#shared_functions" }
      ]
    },

    "line_c": {
      "comment": "Lines tagged with #C at end (but NOT #C++) — colored like C",
      "begin": "^(?=.*#\\s*C\\s*$)(?!.*#\\s*C\\+\\+)",
      "end":   "$",
      "name":  "meta.line.c.quantum",
      "patterns": [
        { "include": "#c_comment" },
        { "include": "#shared_strings" },
        { "include": "#shared_numbers" },
        { "include": "#c_types" },
        { "include": "#c_keywords" },
        { "include": "#c_builtins" },
        { "include": "#shared_operators" },
        { "include": "#shared_functions" }
      ]
    },

    "line_js": {
      "comment": "Lines tagged with #JS or #JavaScript — colored like JavaScript",
      "begin": "^(?=.*#\\s*(JS|JavaScript)\\s*$)",
      "end":   "$",
      "name":  "meta.line.js.quantum",
      "patterns": [
        { "include": "#js_comment" },
        { "include": "#shared_strings" },
        { "include": "#shared_numbers" },
        { "include": "#js_keywords" },
        { "include": "#js_builtins" },
        { "include": "#js_constants" },
        { "include": "#shared_operators" },
        { "include": "#shared_functions" }
      ]
    },

    "line_default": {
      "comment": "Default Quantum line — no trailing tag",
      "patterns": [
        { "include": "#line_comment_green" },
        { "include": "#shared_strings" },
        { "include": "#shared_numbers" },
        { "include": "#quantum_keywords" },
        { "include": "#quantum_cyber_reserved" },
        { "include": "#quantum_builtins" },
        { "include": "#quantum_constants" },
        { "include": "#shared_operators" },
        { "include": "#shared_functions" }
      ]
    },

    "python_comment": {
      "name": "comment.line.number-sign.quantum",
      "match": "#.*$"
    },
    "c_comment": {
      "name": "comment.line.number-sign.quantum",
      "match": "#.*$"
    },
    "cpp_comment": {
      "name": "comment.line.number-sign.quantum",
      "match": "#.*$"
    },
    "js_comment": {
      "name": "comment.line.number-sign.quantum",
      "match": "#.*$"
    },

    "python_keywords": {
      "patterns": [
        {
          "name": "keyword.control.python.quantum",
          "match": "\\b(if|elif|else|for|while|break|continue|return|pass|with|as|from|import|raise|try|except|finally|yield|del|assert|lambda|and|or|not|in|is)\\b"
        },
        {
          "name": "storage.type.python.quantum",
          "match": "\\b(def|class)\\b"
        },
        {
          "name": "storage.modifier.python.quantum",
          "match": "\\b(global|nonlocal|self)\\b"
        }
      ]
    },
    "python_builtins": {
      "name": "support.function.builtin.python.quantum",
      "match": "\\b(print|input|len|range|list|dict|set|tuple|type|int|float|str|bool|abs|min|max|sum|sorted|reversed|enumerate|zip|map|filter|open|repr|format|hasattr|getattr|setattr|isinstance|issubclass|super)\\b"
    },
    "python_constants": {
      "name": "constant.language.python.quantum",
      "match": "\\b(True|False|None)\\b"
    },

    "c_types": {
      "name": "storage.type.c.quantum",
      "match": "\\b(void|char|short|int|long|float|double|signed|unsigned|size_t|uint8_t|uint16_t|uint32_t|uint64_t|int8_t|int16_t|int32_t|int64_t)\\b"
    },
    "c_keywords": {
      "name": "keyword.control.c.quantum",
      "match": "\\b(if|else|for|while|do|switch|case|default|break|continue|return|goto|typedef|struct|enum|union|sizeof|const|static|extern|register|volatile|inline)\\b"
    },
    "c_builtins": {
      "name": "support.function.builtin.c.quantum",
      "match": "\\b(printf|scanf|fprintf|fscanf|sprintf|sscanf|fopen|fclose|fread|fwrite|fgets|fputs|gets|puts|getchar|putchar|malloc|calloc|realloc|free|strlen|strcpy|strncpy|strcmp|strncmp|strcat|strncat|strchr|strstr|memcpy|memset|memcmp|atoi|atof|exit|abort)\\b"
    },

    "cpp_types": {
      "name": "storage.type.cpp.quantum",
      "match": "\\b(void|char|short|int|long|float|double|bool|auto|size_t|string|wchar_t|uint8_t|uint16_t|uint32_t|uint64_t|int8_t|int16_t|int32_t|int64_t)\\b"
    },
    "cpp_keywords": {
      "patterns": [
        {
          "name": "keyword.control.cpp.quantum",
          "match": "\\b(if|else|for|while|do|switch|case|default|break|continue|return|goto|try|catch|throw|sizeof|new|delete|this)\\b"
        },
        {
          "name": "storage.type.cpp.quantum",
          "match": "\\b(class|struct|enum|union|namespace|template|typename|typedef)\\b"
        },
        {
          "name": "storage.modifier.cpp.quantum",
          "match": "\\b(public|private|protected|virtual|override|const|constexpr|static|extern|inline|explicit|friend|using)\\b"
        }
      ]
    },
    "cpp_builtins": {
      "name": "support.function.builtin.cpp.quantum",
      "match": "\\b(cout|cin|cerr|clog|endl|printf|scanf|strlen|strcmp|to_string|stoi|stof|stod|push_back|pop_back|begin|end|size|empty|find|insert|erase|clear|sort|reverse|make_pair|make_shared|make_unique)\\b"
    },

    "js_keywords": {
      "patterns": [
        {
          "name": "keyword.control.js.quantum",
          "match": "\\b(if|else|for|while|do|switch|case|default|break|continue|return|try|catch|finally|throw|of|in|instanceof|typeof|void|delete|new|this|super|yield|await)\\b"
        },
        {
          "name": "storage.type.js.quantum",
          "match": "\\b(var|let|const|function|class|import|export|from|as|async)\\b"
        }
      ]
    },
    "js_builtins": {
      "name": "support.function.builtin.js.quantum",
      "match": "\\b(console|Math|JSON|Array|Object|String|Number|Boolean|Promise|setTimeout|setInterval|clearTimeout|clearInterval|parseInt|parseFloat|isNaN|isFinite|encodeURI|decodeURI|fetch)\\b"
    },
    "js_constants": {
      "name": "constant.language.js.quantum",
      "match": "\\b(true|false|null|undefined|NaN|Infinity)\\b"
    },

    "quantum_keywords": {
      "patterns": [
        {
          "name": "keyword.control.quantum",
          "match": "\\b(if|elif|else|for|while|break|continue|return|in|and|or|not|import)\\b"
        },
        {
          "name": "storage.type.quantum",
          "match": "\\b(fn|def|function|class|extends)\\b"
        },
        {
          "name": "storage.modifier.quantum",
          "match": "\\b(let|const|self|int|float|double|char|bool|void|long|short|unsigned|signed|string)\\b"
        }
      ]
    },
    "quantum_cyber_reserved": {
      "name": "keyword.other.cybersecurity.quantum",
      "match": "\\b(scan|payload|encrypt|decrypt|hash)\\b"
    },
    "quantum_builtins": {
      "name": "support.function.builtin.quantum",
      "match": "\\b(print|printf|scanf|cout|cin|input|len|range|type|num|str|bool|abs|sqrt|pow|floor|ceil|round|log|log2|sin|cos|tan|min|max|rand|rand_int|time|sleep|exit|assert|format|hex|bin|ord|chr|to_hex|from_hex|xor_bytes|base64_encode|rot13|keys|values)\\b"
    },
    "quantum_constants": {
      "name": "constant.language.quantum",
      "match": "\\b(true|false|null|nil|PI|E|INF)\\b"
    },

    "shared_strings": {
      "patterns": [
        {
          "name": "string.quoted.double.quantum",
          "begin": "\"",
          "end":   "\"",
          "patterns": [
            { "name": "constant.character.escape.quantum", "match": "\\\\." }
          ]
        },
        {
          "name": "string.quoted.single.quantum",
          "begin": "'",
          "end":   "'",
          "patterns": [
            { "name": "constant.character.escape.quantum", "match": "\\\\." }
          ]
        }
      ]
    },

    "shared_numbers": {
      "patterns": [
        {
          "name": "constant.numeric.hex.quantum",
          "match": "\\b0x[0-9a-fA-F]+\\b"
        },
        {
          "name": "constant.numeric.binary.quantum",
          "match": "\\b0b[01]+\\b"
        },
        {
          "name": "constant.numeric.quantum",
          "match": "\\b\\d+(\\.\\d+)?([eE][+-]?\\d+)?\\b"
        }
      ]
    },

    "shared_operators": {
      "patterns": [
        {
          "name": "keyword.operator.comparison.quantum",
          "match": "(==|!=|<=|>=|<|>)"
        },
        {
          "name": "keyword.operator.assignment.quantum",
          "match": "(\\+=|-=|\\*=|/=|%=|\\*\\*=|&=|\\|=|\\^=|<<=|>>=|=)"
        },
        {
          "name": "keyword.operator.increment.quantum",
          "match": "(\\+\\+|--)"
        },
        {
          "name": "keyword.operator.arithmetic.quantum",
          "match": "(\\*\\*|\\+|-|\\*|/|%)"
        },
        {
          "name": "keyword.operator.bitwise.quantum",
          "match": "(<<|>>|&|\\||\\^|~)"
        },
        {
          "name": "keyword.operator.arrow.quantum",
          "match": "(=>|->)"
        }
      ]
    },

    "shared_functions": {
      "name": "entity.name.function.quantum",
      "match": "\\b([a-zA-Z_][a-zA-Z0-9_]*)(?=\\s*\\()"
    }
  }
}
